"use strict";(self["webpackChunksupermail"]=self["webpackChunksupermail"]||[]).push([[383],{3388:function(t,e,c){c.d(e,{Z:function(){return l}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nav-bar"},[e("div",{staticClass:"left"},[t._t("left")],2),e("div",{staticClass:"center"},[t._t("center")],2),e("div",{staticClass:"right"},[t._t("right")],2)])},i=[],r={name:"nav-bar"},a=r,n=c(1001),o=(0,n.Z)(a,s,i,!1,null,null,null),l=o.exports},1383:function(t,e,c){c.r(e),c.d(e,{default:function(){return j}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cart"},[e("nav-bar",{staticClass:"nav-bar"},[e("div",{attrs:{slot:"center"},slot:"center"},[t._v("购物车("+t._s(t.cartLength)+")")])]),e("cart-list"),e("cart-aggregate",{staticClass:"aggregate"})],1)},i=[],r=c(3388),a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cart-list"},[e("div",{ref:"scroll",staticClass:"content"},t._l(t.cartList,(function(t){return e("cart-list-item",{key:t.iid,attrs:{product:t}})})),1)])},n=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cart-list-item"},[e("div",{staticClass:"check"},[e("check-button",{attrs:{value:t.product.checked},on:{checkBtnClick:function(e){return t.checkBtnClick()}}})],1),e("div",{staticClass:"image"},[e("figure",{style:t.figureBackGround})]),e("div",{staticClass:"info"},[e("div",{staticClass:"title"},[t._v(t._s(t.product.title))]),e("div",{staticClass:"desc"},[t._v(t._s(t.product.desc))]),e("div",{staticClass:"bottom"},[e("div",{staticClass:"price"},[t._v("￥"+t._s(t.product.price))]),e("div",{staticClass:"count"},[t._v("×"+t._s(t.product.count))])])])])},l=[],u=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"icon-selector",class:{"selector-active":t.checked},on:{click:t.selectItem}},[e("img",{attrs:{src:c(3476),alt:""}})])])},h=[],d={name:"CheckButton",props:{value:{type:Boolean,default:!0}},data:function(){return{checked:this.value}},methods:{selectItem:function(){this.$emit("checkBtnClick")}},watch:{value:function(t){this.checked=t}}},f=d,v=c(1001),m=(0,v.Z)(f,u,h,!1,null,"2f7832e2",null),C=m.exports,g={props:{product:{type:Object,default(){return{}}}},data(){return{}},computed:{figureBackGround(){return`background-image: url(${this.product.image});`}},methods:{checkBtnClick(){this.product.checked=!this.product.checked}},components:{CheckButton:C}},k=g,p=(0,v.Z)(k,o,l,!1,null,"796d20de",null),_=p.exports,L=c(3822),b={computed:{...(0,L.Se)(["cartList"])},activated(){},components:{CartListItem:_}},B=b,w=(0,v.Z)(B,a,n,!1,null,"723acee4",null),T=w.exports,S=function(){var t=this,e=t._self._c;return e("div",{staticClass:"aggregate"},[e("div",{staticClass:"checked-all"},[e("check-button",{attrs:{value:t.isSelectAll},on:{checkBtnClick:function(e){return t.checkBtnClick()}}}),e("span",[t._v("全选")])],1),e("div",{staticClass:"sum-price"},[t._v("合计:￥"+t._s(t.sumPrice))]),e("div",{staticClass:"settle",on:{click:function(e){return t.settleClick()},dblclick:function(e){return t.clearCart()},touchstart:function(e){return t.startTouch()},touchend:function(e){return t.endTouch()}}},[t._v(" 去结算("+t._s(t.caculate)+") ")])])},A=[],Z={name:"CartAggregate",data(){return{longTouchTimer:null}},methods:{checkBtnClick(){this.isSelectAll?this.cartList.forEach((t=>{t.checked=!1})):this.cartList.forEach((t=>{t.checked=!0}))},settleClick(){this.caculate<=0?this.$toast.show("当前没有选择任何商品"):this.$toast.show("余额不足，无法购买,长按或双击以清空购物车")},clearCart(){this.$store.dispatch("clearAllCart").then((t=>{this.$toast.show(t)}))},startTouch(){this.longTouchTimer=setTimeout((()=>{this.cartList()}),300)},endTouch(){clearTimeout(this.longTouchTimer)}},computed:{...(0,L.Se)(["cartList"]),sumPrice(){return this.cartList.reduce(((t,e)=>t+(e.checked?e.price*e.count:0)),0).toFixed(2)},caculate(){let t=0;return this.cartList.forEach((e=>{e.checked&&t++})),t},isSelectAll(){return 0!==this.cartList.length&&this.cartList.every((t=>t.checked))}},components:{CheckButton:C}},x=Z,I=(0,v.Z)(x,S,A,!1,null,"7a8e6e80",null),P=I.exports,$=c(7298),y=c(9459),N={name:"Cart",computed:{...(0,L.Se)(["cartLength","cartList"])},activated(){this.getLoginStatus()&&this.getCart()},methods:{getCart(){(0,$.dv)(this.getAuth()).then((t=>{this.$store.state.cartList=[],t.data.forEach((t=>{(0,y.Nm)(t.iid).then((e=>{const c=e.result;let s={};s.image=c.itemInfo.topImages[0],s.title=c.itemInfo.title,s.desc=c.itemInfo.desc,s.price=c.itemInfo.lowNowPrice,s.iid=t.iid,s.count=t.count,this.addDirectCart(s).then((t=>{}))}))}))}))},...(0,L.Se)(["getLoginStatus","getAuth"]),...(0,L.nv)(["addDirectCart"])},components:{NavBar:r.Z,CartList:T,CartAggregate:P}},D=N,E=(0,v.Z)(D,s,i,!1,null,"bd9e2a30",null),j=E.exports},9459:function(t,e,c){c.d(e,{Nm:function(){return i},ZA:function(){return a},k3:function(){return n},oD:function(){return o},tL:function(){return r}});var s=c(7707);function i(t){return(0,s.W)({url:`detail/detail_iid=${t}.json`})}function r(){return(0,s.W)({url:"recommend.json"})}class a{constructor(t,e,c){this.title=t.title,this.desc=t.desc,this.newPrice=t.price,this.oldPrice=t.oldPrice,this.discount=t.discountDesc,this.columns=e,this.services=c,this.nowPrice=t.lowNowPrice}}class n{constructor(t){this.logo=t.shopLogo,this.name=t.name,this.fans=t.cFans,this.sells=t.cSells,this.score=t.score,this.goodsCount=t.cGoods}}class o{constructor(t,e){this.image=t.images?t.images[0]:"",this.infos=t.set,this.sizes=e.tables}}},3476:function(t,e,c){t.exports=c.p+"img/tick.82dd6e3a.svg"}}]);
//# sourceMappingURL=383.46988253.js.map